{"ast":null,"code":"import CartService from '../services/CartService.js';\nclass CartController {\n  constructor() {\n    // === ĐỒNG BỘ KHI ĐĂNG NHẬP ===\n    this.setAuth = userId => {\n      this.cartService.setAuth(userId);\n    };\n    // === NOTIFY SYSTEM ===\n    this._listeners = [];\n    this.subscribe = cb => {\n      this._listeners.push(cb);\n      return () => {\n        this._listeners = this._listeners.filter(x => x !== cb);\n      };\n    };\n    this._notify = () => {\n      const items = this.getCartItems();\n      this._listeners.forEach(cb => cb(items));\n    };\n    if (CartController.instance) return CartController.instance;\n    this.cartService = new CartService();\n    CartController.instance = this;\n  }\n  async addToCart(product) {\n    const updatedCart = await this.cartService.addToCart(product);\n    this._notify();\n    return updatedCart; // Trả về mảng đã cập nhật\n  }\n  async removeFromCart(productId) {\n    const updatedCart = await this.cartService.removeFromCart(productId);\n    this._notify();\n    return updatedCart;\n  }\n  async updateQuantity(productId, quantity) {\n    const updatedCart = await this.cartService.updateQuantity(productId, quantity);\n    this._notify();\n    return updatedCart;\n  }\n  async clearCart() {\n    const updatedCart = await this.cartService.clearCart();\n    this._notify();\n    return updatedCart;\n  }\n  getCartItems() {\n    return this.cartService.getCartItems();\n  }\n  getTotalQuantity() {\n    return this.cartService.getTotalQuantity();\n  }\n  getTotalPrice() {\n    return this.cartService.getTotalPrice();\n  }\n}\n\n// SINGLETON\nconst cartController = new CartController();\nObject.freeze(cartController);\nexport default CartController;","map":{"version":3,"names":["CartService","CartController","constructor","setAuth","userId","cartService","_listeners","subscribe","cb","push","filter","x","_notify","items","getCartItems","forEach","instance","addToCart","product","updatedCart","removeFromCart","productId","updateQuantity","quantity","clearCart","getTotalQuantity","getTotalPrice","cartController","Object","freeze"],"sources":["D:/Hoang.bk/Documents/GitHub/HHSHOP/Frontend/src/controllers/CartController.js"],"sourcesContent":["import CartService from '../services/CartService.js';\r\n\r\nclass CartController {\r\n  constructor() {\r\n    if (CartController.instance) return CartController.instance;\r\n    this.cartService = new CartService();\r\n    CartController.instance = this;\r\n  }\r\n  \r\n  // === ĐỒNG BỘ KHI ĐĂNG NHẬP ===\r\n  setAuth = (userId) => {\r\n    this.cartService.setAuth(userId);\r\n  };\r\n\r\n  async addToCart(product) {\r\n    const updatedCart = await this.cartService.addToCart(product);\r\n    this._notify();\r\n    return updatedCart; // Trả về mảng đã cập nhật\r\n  }\r\n\r\n  async removeFromCart(productId) {\r\n    const updatedCart = await this.cartService.removeFromCart(productId);\r\n    this._notify();\r\n    return updatedCart;\r\n  }\r\n\r\n  async updateQuantity(productId, quantity) {\r\n    const updatedCart = await this.cartService.updateQuantity(productId, quantity);\r\n    this._notify();\r\n    return updatedCart;\r\n  }\r\n\r\n  async clearCart() {\r\n    const updatedCart = await this.cartService.clearCart();\r\n    this._notify();\r\n    return updatedCart;\r\n  }\r\n\r\n  getCartItems() {\r\n    return this.cartService.getCartItems();\r\n  }\r\n\r\n  getTotalQuantity() {\r\n    return this.cartService.getTotalQuantity();\r\n  }\r\n\r\n  getTotalPrice() {\r\n    return this.cartService.getTotalPrice();\r\n  }\r\n  \r\n  // === NOTIFY SYSTEM ===\r\n  _listeners = [];\r\n  subscribe = (cb) => {\r\n    this._listeners.push(cb);\r\n    return () => {\r\n      this._listeners = this._listeners.filter(x => x !== cb);\r\n    };\r\n  };\r\n  _notify = () => {\r\n    const items = this.getCartItems();\r\n    this._listeners.forEach(cb => cb(items));\r\n  };\r\n}\r\n\r\n// SINGLETON\r\nconst cartController = new CartController();\r\nObject.freeze(cartController);\r\n\r\nexport default CartController;"],"mappings":"AAAA,OAAOA,WAAW,MAAM,4BAA4B;AAEpD,MAAMC,cAAc,CAAC;EACnBC,WAAWA,CAAA,EAAG;IAMd;IAAA,KACAC,OAAO,GAAIC,MAAM,IAAK;MACpB,IAAI,CAACC,WAAW,CAACF,OAAO,CAACC,MAAM,CAAC;IAClC,CAAC;IAsCD;IAAA,KACAE,UAAU,GAAG,EAAE;IAAA,KACfC,SAAS,GAAIC,EAAE,IAAK;MAClB,IAAI,CAACF,UAAU,CAACG,IAAI,CAACD,EAAE,CAAC;MACxB,OAAO,MAAM;QACX,IAAI,CAACF,UAAU,GAAG,IAAI,CAACA,UAAU,CAACI,MAAM,CAACC,CAAC,IAAIA,CAAC,KAAKH,EAAE,CAAC;MACzD,CAAC;IACH,CAAC;IAAA,KACDI,OAAO,GAAG,MAAM;MACd,MAAMC,KAAK,GAAG,IAAI,CAACC,YAAY,CAAC,CAAC;MACjC,IAAI,CAACR,UAAU,CAACS,OAAO,CAACP,EAAE,IAAIA,EAAE,CAACK,KAAK,CAAC,CAAC;IAC1C,CAAC;IAzDC,IAAIZ,cAAc,CAACe,QAAQ,EAAE,OAAOf,cAAc,CAACe,QAAQ;IAC3D,IAAI,CAACX,WAAW,GAAG,IAAIL,WAAW,CAAC,CAAC;IACpCC,cAAc,CAACe,QAAQ,GAAG,IAAI;EAChC;EAOA,MAAMC,SAASA,CAACC,OAAO,EAAE;IACvB,MAAMC,WAAW,GAAG,MAAM,IAAI,CAACd,WAAW,CAACY,SAAS,CAACC,OAAO,CAAC;IAC7D,IAAI,CAACN,OAAO,CAAC,CAAC;IACd,OAAOO,WAAW,CAAC,CAAC;EACtB;EAEA,MAAMC,cAAcA,CAACC,SAAS,EAAE;IAC9B,MAAMF,WAAW,GAAG,MAAM,IAAI,CAACd,WAAW,CAACe,cAAc,CAACC,SAAS,CAAC;IACpE,IAAI,CAACT,OAAO,CAAC,CAAC;IACd,OAAOO,WAAW;EACpB;EAEA,MAAMG,cAAcA,CAACD,SAAS,EAAEE,QAAQ,EAAE;IACxC,MAAMJ,WAAW,GAAG,MAAM,IAAI,CAACd,WAAW,CAACiB,cAAc,CAACD,SAAS,EAAEE,QAAQ,CAAC;IAC9E,IAAI,CAACX,OAAO,CAAC,CAAC;IACd,OAAOO,WAAW;EACpB;EAEA,MAAMK,SAASA,CAAA,EAAG;IAChB,MAAML,WAAW,GAAG,MAAM,IAAI,CAACd,WAAW,CAACmB,SAAS,CAAC,CAAC;IACtD,IAAI,CAACZ,OAAO,CAAC,CAAC;IACd,OAAOO,WAAW;EACpB;EAEAL,YAAYA,CAAA,EAAG;IACb,OAAO,IAAI,CAACT,WAAW,CAACS,YAAY,CAAC,CAAC;EACxC;EAEAW,gBAAgBA,CAAA,EAAG;IACjB,OAAO,IAAI,CAACpB,WAAW,CAACoB,gBAAgB,CAAC,CAAC;EAC5C;EAEAC,aAAaA,CAAA,EAAG;IACd,OAAO,IAAI,CAACrB,WAAW,CAACqB,aAAa,CAAC,CAAC;EACzC;AAcF;;AAEA;AACA,MAAMC,cAAc,GAAG,IAAI1B,cAAc,CAAC,CAAC;AAC3C2B,MAAM,CAACC,MAAM,CAACF,cAAc,CAAC;AAE7B,eAAe1B,cAAc","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}